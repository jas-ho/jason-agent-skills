{"id":"jas-4pz","title":"Expand skitour skill to cover major Austrian touring regions","description":"## Architecture Change Required\n**Dual-API support** - different endpoints for different regions:\n\n| Region | API Endpoint |\n|--------|--------------|\n| AT-02 (Carinthia) | `static.avalanche.report/bulletins/{date}/AT-02.json` |\n| AT-03 (Lower Austria) | `static.lawinen-warnung.eu/bulletins/latest/AT-03.json` |\n| AT-06 (Styria) | `static.lawinen-warnung.eu/bulletins/latest/AT-06.json` |\n| AT-07 (Tyrol) | `static.avalanche.report/bulletins/{date}/AT-07.json` |\n| AT-08 (Vorarlberg) | `static.lawinen-warnung.eu/bulletins/latest/AT-08.json` |\n\n## Code Changes\n\n### 1. Update get_avalanche_data() to handle both APIs\n```bash\nget_avalanche_data() {\n    local region_code=\"$1\"\n    local micro_region=\"$2\"\n    local url\n    \n    case \"$region_code\" in\n        AT-02|AT-07)\n            local today=$(date +%Y-%m-%d)\n            url=\"https://static.avalanche.report/bulletins/${today}/${region_code}.json\"\n            ;;\n        *)\n            url=\"https://static.lawinen-warnung.eu/bulletins/latest/${region_code}.json\"\n            ;;\n    esac\n    # ... rest unchanged\n}\n```\n\n### 2. New Locations to Add\n\n**Tyrol (AT-07)** - ~12 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| stubai | 47.08,11.31 | AT-07-22 (Stubaier Alpen Mitte) |\n| oetztal | 46.90,10.86 | AT-07-20 (WeiÃŸkugelgruppe) |\n| soelden | 46.97,10.88 | AT-07-21 (Gurgler Gruppe) |\n| zillertal | 47.05,11.88 | AT-07-23-01 (Zillertaler NW) |\n| hintertux | 47.10,11.67 | AT-07-15 (Tuxer Alpen West) |\n| kuehtai | 47.21,11.02 | AT-07-14-02 (KÃ¼htai-Geigenkamm) |\n| sellrain | 47.18,11.13 | AT-07-14-03 (Sellrain-Alpeiner) |\n| arlberg | 47.13,10.21 | AT-07-10 (Verwallgruppe Mitte) |\n| silvretta | 46.92,10.10 | AT-07-12 (Silvretta Ost) |\n| kaunertal | 46.98,10.71 | AT-07-14-01 (Kaunergrat) |\n| karwendel | 47.40,11.45 | AT-07-04-01 (Karwendel West) |\n| kitzbuhel | 47.45,12.39 | AT-07-17-01 (KitzbÃ¼heler Brixental) |\n\n**Salzburg (AT-05)** - ~6 locations (pending API verification)\n\n**Carinthia (AT-02)** - ~4 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| grossglockner | 47.08,12.76 | AT-02-01-01 (Glocknergruppe) |\n| nockberge | 46.90,13.78 | AT-02-04-01 (Nockberge Mitte) |\n| karawanken | 46.47,14.25 | AT-02-18 (Karawanken Mitte) |\n| ankogel | 47.05,13.25 | AT-02-03-01-01 (Ankogel-Hochalm) |\n\n**Vorarlberg (AT-08)** - ~4 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| lech | 47.21,10.14 | AT-08-05-01 |\n| montafon | 47.00,9.98 | AT-08-04 |\n| kleinwalsertal | 47.35,10.18 | AT-08-03-01 |\n| bregenzerwald | 47.38,9.90 | AT-08-01 |\n\n### 3. Update REGION_NAMES array\nAdd all new micro-region display names (extracted from CAAML XML).\n\n## Acceptance Criteria\n- [ ] Dual-API support working (avalanche.report + lawinen-warnung.eu)\n- [ ] 12+ Tyrol locations with correct micro-regions\n- [ ] 4+ Carinthia locations\n- [ ] 4+ Vorarlberg locations\n- [ ] All new regions in REGION_NAMES\n- [ ] Test each with --compare flag\n- [ ] SKILL.md updated with location list","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-10T20:55:01.019521+01:00","created_by":"jason","updated_at":"2026-01-10T22:16:33.872961+01:00","closed_at":"2026-01-10T22:16:33.872961+01:00","close_reason":"Completed: Added 18 new locations (11 Tyrol, 3 Carinthia, 4 Vorarlberg) with dual-API support. Coordinates verified via Nominatim. Commit: e6ecd1c. Note: Salzburg (AT-05) not added - API returns malformed JSON, needs investigation."}
{"id":"jas-4vx","title":"Standardize error message format and add missing validation","description":"Inconsistencies found by review:\n1. Error prefixes: 'ERROR:' vs 'Error:' vs no prefix\n2. Lat/lon regex allows malformed floats like '123.45.67'\n3. Python region_lookup.py stderr suppressed (2\u003e/dev/null)\n4. Bare 'except Exception' in Python should be specific\n\nStandardize on:\n- 'Error:' prefix (capitalized, not ALL CAPS)\n- 'Warning:' for non-fatal\n- Fix regex: ^\\-?[0-9]+(\\.[0-9]+)?$","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T22:36:36.726136+01:00","created_by":"jason","updated_at":"2026-01-10T22:36:36.726136+01:00"}
{"id":"jas-6z2","title":"Remove unused SCRIPT_DIR variable","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-10T16:28:10.474592+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.566755+01:00","closed_at":"2026-01-10T16:46:55.567869+01:00","close_reason":"Already removed during P1 fixes"}
{"id":"jas-885","title":"Add example output to skitour SKILL.md","description":"## Task\nCapture actual script output and add to SKILL.md as example.\n\n## Steps\n1. Run: `./skitour.sh --location rax`\n2. Capture output (sanitize any timing variations)\n3. Add to SKILL.md under `## Example Output` section\n\n## Format\n```\n## Example Output\n\n\\`\\`\\`\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n  ğŸ“ RAX (Rax - Schneeberggebiet)\n     Coordinates: 47.706Â°N, 15.733Â°E\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nğŸ”º AVALANCHE DANGER\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   Above treeline: 2 - Moderate\n   Below treeline: 1 - Low\n   ...\n\\`\\`\\`\n```\n\n## Acceptance Criteria\n- [ ] Example output added to SKILL.md\n- [ ] Shows all three data sections (avalanche, snow, weather)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T16:28:11.060575+01:00","created_by":"jason","updated_at":"2026-01-10T22:33:19.690275+01:00","closed_at":"2026-01-10T22:33:19.690275+01:00","close_reason":"Documentation updated in SKILL.md with prerequisites (bash 4+, uv, jq/curl/bc), 26-location table by region, example output section, and limitations"}
{"id":"jas-8ln","title":"Add curl timeout to prevent hangs","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:27:58.02433+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.564734+01:00","closed_at":"2026-01-10T16:44:44.340776+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-8ti","title":"Update SKILL.md: clarify uv is only needed for coordinate lookup","description":"Documentation review found:\n1. uv listed as required prereq but only needed for --lat/--lon feature\n2. Example output date (2026-01-10) will go stale - add note it's an example\n3. Could better explain coordinate auto-detection uses Python helper\n\nMinor updates to improve accuracy.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T22:36:37.233379+01:00","created_by":"jason","updated_at":"2026-01-10T22:36:37.233379+01:00"}
{"id":"jas-a5f","title":"Fix exit code for unknown options","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T16:27:59.49102+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.563881+01:00","closed_at":"2026-01-10T16:44:44.34185+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-e80","title":"Add more touring locations to skitour","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-10T16:28:11.631625+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.567169+01:00","closed_at":"2026-01-10T20:54:45.993866+01:00","close_reason":"Superseded by more detailed issue with concrete implementation plan"}
{"id":"jas-eci","title":"Adopt pre-commit hooks from apart-kit","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:11.907891+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.565171+01:00","closed_at":"2026-01-10T16:46:23.080002+01:00","close_reason":"Added .pre-commit-config.yaml with gitleaks, shellcheck, file hygiene hooks"}
{"id":"jas-ivg","title":"Optimize jq calls in weather display loop","description":"## Problem\nThe weather display loop (lines 212-225) calls jq 5 times per iteration for 12 iterations = **60 jq process spawns**.\n\n## Current Code (lines 212-225)\n```bash\nfor i in {0..11}; do\n    hour=$(echo \"$weather_json\" | jq -r \".hourly.time[$i]...\")\n    temp=$(echo \"$weather_json\" | jq -r \".hourly.temperature_2m[$i]...\")\n    wind=$(echo \"$weather_json\" | jq -r \".hourly.windspeed_10m[$i]...\")\n    cloud=$(echo \"$weather_json\" | jq -r \".hourly.cloudcover[$i]...\")\n    precip=$(echo \"$weather_json\" | jq -r \".hourly.precipitation_probability[$i]...\")\n    printf ...\ndone\n```\n\n## Solution\nSingle jq call that outputs pre-formatted lines:\n```bash\necho \"$weather_json\" | jq -r '\n    [range(12)] | .[] as $i |\n    \"\\(.hourly.time[$i] | split(\"T\")[1] | split(\":\")[0]) \\(.hourly.temperature_2m[$i]) \\(.hourly.windspeed_10m[$i]) \\(.hourly.cloudcover[$i]) \\(.hourly.precipitation_probability[$i])\"\n' | while read hour temp wind cloud precip; do\n    printf \"   %02d:00 %5.1fÂ°C %5.0fkm/h %4.0f%%   %3.0f%%\\n\" \"$hour\" \"$temp\" \"$wind\" \"$cloud\" \"$precip\"\ndone\n```\n\n## Acceptance Criteria\n- [ ] Replace 60 jq calls with 1\n- [ ] Output unchanged\n- [ ] Handle empty/error weather data gracefully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:00.830761+01:00","created_by":"jason","updated_at":"2026-01-10T22:01:21.614068+01:00","closed_at":"2026-01-10T22:01:21.614068+01:00","close_reason":"Completed: Reduced 60 jq calls to 1 using single jq filter with tab-separated output piped to while loop. Commit: 75549f7"}
{"id":"jas-kjq","title":"Add argument validation for CLI options","description":"## Current State\nNo validation - unknown options silently fail, invalid coords accepted.\n\n## Validations to Add\n\n### 1. Unknown option handling (line 243)\n```bash\n*) echo \"Unknown option: $1\" \u003e\u00262; usage; exit 1 ;;\n```\n**Fix**: Show available options before exiting.\n\n### 2. Latitude/longitude range validation\n```bash\n# After parsing --lat/--lon\nif [[ -n \"$lat\" ]]; then\n    if ! [[ \"$lat\" =~ ^-?[0-9]+\\.?[0-9]*$ ]] || \\\n       (( $(echo \"$lat \u003c 45 || $lat \u003e 49\" | bc -l) )); then\n        echo \"Error: Latitude must be between 45-49 (Austria)\" \u003e\u00262\n        exit 1\n    fi\nfi\n# Similar for lon (9-18 for Austria)\n```\n\n### 3. Empty location name\n```bash\nif [[ -z \"$location\" \u0026\u0026 -z \"$lat\" \u0026\u0026 -z \"$lon\" \u0026\u0026 -z \"$compare\" ]]; then\n    usage\nfi\n```\n\n### 4. Partial coordinate (lat without lon)\n```bash\nif [[ -n \"$lat\" \u0026\u0026 -z \"$lon\" ]] || [[ -z \"$lat\" \u0026\u0026 -n \"$lon\" ]]; then\n    echo \"Error: Both --lat and --lon required for coordinate lookup\" \u003e\u00262\n    exit 1\nfi\n```\n\n## Acceptance Criteria\n- [ ] Unknown options show help and exit 1\n- [ ] Invalid lat/lon shows error with valid range\n- [ ] Missing paired lat/lon shows clear error\n- [ ] Empty compare list handled gracefully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:10.212977+01:00","created_by":"jason","updated_at":"2026-01-10T22:04:57.575684+01:00","closed_at":"2026-01-10T22:04:57.575684+01:00","close_reason":"Completed: Added validation for unknown options, partial coords, invalid format, and out-of-Austria warning. Commit: d6913ae"}
{"id":"jas-l6b","title":"Consider migrating custom slash commands to this repo","description":"## Status: DEFERRED\n\nUser decision: Keep commands in ~/.claude/commands/ separate from this skills repo for now. Revisit later.\n\n## Original Context\nEvaluate moving personal Claude Code slash commands from ~/.claude/commands/ to this marketplace repo.\n\n**Current location**: ~/.claude/commands/*.md\n**Examples**: sync-dotfiles, sync-claude-config, etc.\n\n**Questions to resolve** (when revisited):\n- Should these be plugins (with SKILL.md) or stay as simple .md commands?\n- Which commands are general-purpose vs personal?\n- How to handle commands that reference user-specific paths?","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T17:16:12.687001+01:00","created_by":"jason","updated_at":"2026-01-10T21:34:03.340023+01:00"}
{"id":"jas-m5q","title":"Document bash 4+ requirement in SKILL.md","description":"## Change\nAdd prerequisites section to SKILL.md documenting all requirements.\n\n## Prerequisites to Document\n1. **bash 4.0+** - Required for associative arrays\n   - macOS ships with bash 3.x, users need `brew install bash`\n2. **uv** - Required for coordinate lookup (region_lookup.py)\n   - Install: `curl -LsSf https://astral.sh/uv/install.sh | sh`\n3. **Runtime deps** (checked by script): jq, curl, bc\n\n## Location\n`plugins/skitour/SKILL.md` - add Prerequisites section:\n\n```markdown\n## Prerequisites\n\n- **bash 4.0+** (for associative arrays)\n  - macOS: `brew install bash`\n  - Linux: Usually pre-installed\n- **uv** (for coordinate lookup feature)\n  - `curl -LsSf https://astral.sh/uv/install.sh | sh`\n- **jq, curl, bc** (checked at runtime)\n```\n\n## Acceptance Criteria\n- [ ] SKILL.md has Prerequisites section\n- [ ] bash 4+ requirement documented with macOS workaround\n- [ ] uv requirement documented with install command\n- [ ] Runtime deps listed","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T16:28:10.745093+01:00","created_by":"jason","updated_at":"2026-01-10T22:33:19.683556+01:00","closed_at":"2026-01-10T22:33:19.683556+01:00","close_reason":"Documentation updated in SKILL.md with prerequisites (bash 4+, uv, jq/curl/bc), 26-location table by region, example output section, and limitations"}
{"id":"jas-maj","title":"Remove unused variable and deduplicate location lookup","description":"Minor cleanup from code review:\n1. Line 176: 'today' variable assigned but never used\n2. Lines 364-365 and 377-378: Identical IFS/read pattern duplicated\n3. Parameter name mismatch: function uses 'micro_region', caller passes 'micro'\n\nCould extract helper function for location lookup pattern.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T22:36:36.986425+01:00","created_by":"jason","updated_at":"2026-01-10T22:36:36.986425+01:00"}
{"id":"jas-n7u","title":"Add dependency checks for jq, curl, bc","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:27:56.636494+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.564954+01:00","closed_at":"2026-01-10T16:44:44.338854+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-o7z","title":"Implement coordinate to region lookup using EAWS polygons","description":"## Goal\nEnable `--lat LAT --lon LON` to automatically determine the correct EAWS micro-region.\n\n## Implementation: Python Helper with UV Script\n\nUse a self-contained Python script with inline dependencies:\n\n```python\n#!/usr/bin/env -S uv run --script\n# /// script\n# requires-python = \"\u003e=3.10\"\n# dependencies = [\"shapely\", \"requests\"]\n# ///\n\nimport sys\nimport json\nimport requests\nfrom shapely.geometry import Point, shape\n\ndef get_region(lat: float, lon: float) -\u003e dict | None:\n    \"\"\"Return {region_code, micro_region, name} for given coordinates.\"\"\"\n    point = Point(lon, lat)  # GeoJSON is lon,lat order\n    \n    # Determine parent region from rough bounds\n    parent = None\n    if 46.7 \u003c= lat \u003c= 47.6 and 10.1 \u003c= lon \u003c= 12.9:\n        parent = \"AT-07\"\n    elif 46.4 \u003c= lat \u003c= 47.2 and 12.7 \u003c= lon \u003c= 15.1:\n        parent = \"AT-02\"\n    # ... etc for AT-03, AT-06, AT-08\n    \n    if not parent:\n        return None\n    \n    # Fetch micro-regions GeoJSON\n    url = f\"https://regions.avalanches.org/micro-regions/{parent}_micro-regions.geojson.json\"\n    resp = requests.get(url, timeout=10)\n    geojson = resp.json()\n    \n    # Find containing region\n    for feature in geojson[\"features\"]:\n        polygon = shape(feature[\"geometry\"])\n        if polygon.contains(point):\n            return {\n                \"region_code\": parent,\n                \"micro_region\": feature[\"properties\"][\"id\"],\n            }\n    \n    return None\n\nif __name__ == \"__main__\":\n    lat, lon = float(sys.argv[1]), float(sys.argv[2])\n    result = get_region(lat, lon)\n    if result:\n        print(json.dumps(result))\n    else:\n        sys.exit(1)\n```\n\n## Integration with skitour.sh\n\n```bash\n# In skitour.sh, when --lat/--lon provided:\nresult=$(uv run --script region_lookup.py \"$lat\" \"$lon\" 2\u003e/dev/null)\nif [[ -n \"$result\" ]]; then\n    region_code=$(echo \"$result\" | jq -r '.region_code')\n    micro_region=$(echo \"$result\" | jq -r '.micro_region')\n    show_location \"custom\" \"$lat\" \"$lon\" \"$region_code\" \"$micro_region\"\nelse\n    echo \"Could not determine avalanche region for coordinates.\"\n    echo \"Use --location with a known location: ${!LOCATIONS[*]}\"\n    exit 1\nfi\n```\n\n## File Structure\n```\nplugins/skitour/\nâ”œâ”€â”€ skitour.sh           # Main script\nâ”œâ”€â”€ region_lookup.py     # UV script helper\nâ””â”€â”€ SKILL.md\n```\n\n## Advantages\n- 100% accurate point-in-polygon with shapely\n- No system-wide Python deps (uv handles isolation)\n- Portable (just needs uv installed, which user has)\n- Simple, readable, maintainable\n- Fast (~0.5s including network fetch)\n\n## Acceptance Criteria\n- [ ] region_lookup.py works standalone: `uv run --script region_lookup.py 47.1 11.3`\n- [ ] skitour.sh --lat 47.1 --lon 11.3 returns Stubai region data\n- [ ] Out-of-Austria coords show clear error\n- [ ] Network errors handled gracefully\n- [ ] SKILL.md documents uv requirement","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-10T16:28:11.347555+01:00","created_by":"jason","updated_at":"2026-01-10T22:30:35.889846+01:00","closed_at":"2026-01-10T22:30:35.889846+01:00","close_reason":"Completed: Implemented region_lookup.py UV script with shapely point-in-polygon. Integrated into skitour.sh for --lat/--lon. Commit: 6db5972"}
{"id":"jas-rvp","title":"Add bash version check at startup","description":"Script uses associative arrays (bash 4.0+ feature) but doesn't verify version at runtime. Users on macOS with default bash 3.x get cryptic errors.\n\nAdd version check after shebang:\n```bash\nif ((BASH_VERSINFO[0] \u003c 4)); then\n    echo \"Error: bash 4.0+ required (found $BASH_VERSION). On macOS: brew install bash\" \u003e\u00262\n    exit 1\nfi\n```","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-10T22:36:36.470767+01:00","created_by":"jason","updated_at":"2026-01-10T22:36:36.470767+01:00"}
{"id":"jas-yn6","title":"Fix function return value handling - exit codes ignored by callers","description":"Critical: get_avalanche_data(), get_snow_depth(), get_weather() return error codes but callers at lines 247, 276, 284 never check them. Functions complete silently with bad data.\n\nAlso: get_weather() returns malformed JSON instead of exit code 1, so caller can't detect failure.\n\nFixes:\n1. Check return values after function calls\n2. Make get_weather() exit non-zero on failure\n3. Distinguish 0cm snow from 'unavailable'","status":"open","priority":1,"issue_type":"bug","created_at":"2026-01-10T22:36:36.205276+01:00","created_by":"jason","updated_at":"2026-01-10T22:36:36.205276+01:00"}
{"id":"jas-z75","title":"Investigate Salzburg (AT-05) avalanche data source","description":"## Background\nDuring jas-4pz implementation, discovered that AT-05 (Salzburg) returns malformed JSON from lawinen-warnung.eu.\n\n## Symptoms\n```bash\ncurl -sf 'https://static.lawinen-warnung.eu/bulletins/latest/AT-05.json' | jq 'length'\n# Returns: jq parse error (control characters)\n```\n\n## Investigation Needed\n1. Check if AT-05 uses a different API (like AT-02/AT-07 use avalanche.report)\n2. Verify if the JSON encoding issue is transient or permanent\n3. Find alternative data source if needed\n\n## Context\nSalzburg is a major touring destination (Pinzgau, Pongau areas) so adding support would be valuable.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T22:19:11.661662+01:00","created_by":"jason","updated_at":"2026-01-10T22:19:11.661662+01:00"}
