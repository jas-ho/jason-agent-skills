{"id":"jas-27b","title":"Complete REGION_NAMES coverage for all Austrian micro-regions","description":"## Problem\nThe `REGION_NAMES` array maps micro-region codes to human-readable names, but not all micro-regions are covered.\n\n## Investigation Finding\nEAWS GeoJSON files (`regions.avalanches.org/micro-regions/`) only contain:\n- id (e.g., AT-07-02-02)\n- start_date\n- end_date\n\n**No name property exists.** Names must be looked up manually from official EAWS documentation or the avalanche.report website.\n\n## Current Coverage\n~30 entries covering the most common touring areas. Unmapped regions fall back to showing raw codes (e.g., \"AT-07-24\") which is acceptable.\n\n## Recommendation\n- Keep current coverage for popular touring areas\n- Fallback to raw codes is fine for less common regions\n- If specific region names are needed, add them incrementally as discovered\n\n## Status\nDeprioritized to P4. Current fallback behavior is acceptable.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-11T09:26:04.492476+01:00","created_by":"jason","updated_at":"2026-01-11T09:35:25.376107+01:00"}
{"id":"jas-4pz","title":"Expand skitour skill to cover major Austrian touring regions","description":"## Architecture Change Required\n**Dual-API support** - different endpoints for different regions:\n\n| Region | API Endpoint |\n|--------|--------------|\n| AT-02 (Carinthia) | `static.avalanche.report/bulletins/{date}/AT-02.json` |\n| AT-03 (Lower Austria) | `static.lawinen-warnung.eu/bulletins/latest/AT-03.json` |\n| AT-06 (Styria) | `static.lawinen-warnung.eu/bulletins/latest/AT-06.json` |\n| AT-07 (Tyrol) | `static.avalanche.report/bulletins/{date}/AT-07.json` |\n| AT-08 (Vorarlberg) | `static.lawinen-warnung.eu/bulletins/latest/AT-08.json` |\n\n## Code Changes\n\n### 1. Update get_avalanche_data() to handle both APIs\n```bash\nget_avalanche_data() {\n    local region_code=\"$1\"\n    local micro_region=\"$2\"\n    local url\n    \n    case \"$region_code\" in\n        AT-02|AT-07)\n            local today=$(date +%Y-%m-%d)\n            url=\"https://static.avalanche.report/bulletins/${today}/${region_code}.json\"\n            ;;\n        *)\n            url=\"https://static.lawinen-warnung.eu/bulletins/latest/${region_code}.json\"\n            ;;\n    esac\n    # ... rest unchanged\n}\n```\n\n### 2. New Locations to Add\n\n**Tyrol (AT-07)** - ~12 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| stubai | 47.08,11.31 | AT-07-22 (Stubaier Alpen Mitte) |\n| oetztal | 46.90,10.86 | AT-07-20 (Wei√ükugelgruppe) |\n| soelden | 46.97,10.88 | AT-07-21 (Gurgler Gruppe) |\n| zillertal | 47.05,11.88 | AT-07-23-01 (Zillertaler NW) |\n| hintertux | 47.10,11.67 | AT-07-15 (Tuxer Alpen West) |\n| kuehtai | 47.21,11.02 | AT-07-14-02 (K√ºhtai-Geigenkamm) |\n| sellrain | 47.18,11.13 | AT-07-14-03 (Sellrain-Alpeiner) |\n| arlberg | 47.13,10.21 | AT-07-10 (Verwallgruppe Mitte) |\n| silvretta | 46.92,10.10 | AT-07-12 (Silvretta Ost) |\n| kaunertal | 46.98,10.71 | AT-07-14-01 (Kaunergrat) |\n| karwendel | 47.40,11.45 | AT-07-04-01 (Karwendel West) |\n| kitzbuhel | 47.45,12.39 | AT-07-17-01 (Kitzb√ºheler Brixental) |\n\n**Salzburg (AT-05)** - ~6 locations (pending API verification)\n\n**Carinthia (AT-02)** - ~4 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| grossglockner | 47.08,12.76 | AT-02-01-01 (Glocknergruppe) |\n| nockberge | 46.90,13.78 | AT-02-04-01 (Nockberge Mitte) |\n| karawanken | 46.47,14.25 | AT-02-18 (Karawanken Mitte) |\n| ankogel | 47.05,13.25 | AT-02-03-01-01 (Ankogel-Hochalm) |\n\n**Vorarlberg (AT-08)** - ~4 locations:\n| Name | Coords | Micro-region |\n|------|--------|--------------|\n| lech | 47.21,10.14 | AT-08-05-01 |\n| montafon | 47.00,9.98 | AT-08-04 |\n| kleinwalsertal | 47.35,10.18 | AT-08-03-01 |\n| bregenzerwald | 47.38,9.90 | AT-08-01 |\n\n### 3. Update REGION_NAMES array\nAdd all new micro-region display names (extracted from CAAML XML).\n\n## Acceptance Criteria\n- [ ] Dual-API support working (avalanche.report + lawinen-warnung.eu)\n- [ ] 12+ Tyrol locations with correct micro-regions\n- [ ] 4+ Carinthia locations\n- [ ] 4+ Vorarlberg locations\n- [ ] All new regions in REGION_NAMES\n- [ ] Test each with --compare flag\n- [ ] SKILL.md updated with location list","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-10T20:55:01.019521+01:00","created_by":"jason","updated_at":"2026-01-10T22:16:33.872961+01:00","closed_at":"2026-01-10T22:16:33.872961+01:00","close_reason":"Completed: Added 18 new locations (11 Tyrol, 3 Carinthia, 4 Vorarlberg) with dual-API support. Coordinates verified via Nominatim. Commit: e6ecd1c. Note: Salzburg (AT-05) not added - API returns malformed JSON, needs investigation."}
{"id":"jas-4vx","title":"Standardize error message format and add missing validation","description":"## Problem\nMultiple inconsistencies found by red-team review:\n\n### 1. Error prefix inconsistency\n- `ERROR: Failed to fetch...` (line 149, ALL CAPS)\n- `Error: Invalid latitude...` (line 342, capitalized)\n- `Unknown location: ...` (line 367, no prefix)\n- `Warning: Coordinates...` (line 353, has prefix)\n\n### 2. Lat/lon regex too permissive\nCurrent: `^-?[0-9]+\\.?[0-9]*$`\nAllows malformed floats like \"123.45.67\" or \"-.5\"\n\n### 3. Python stderr suppressed\n```bash\nuv run --script \"$lookup_script\" ... 2\u003e/dev/null  # Hides actual errors\n```\n\n### 4. Bare except Exception in Python (line 71)\nToo broad, could hide unexpected errors.\n\n## Agreed Approach\n1. **Standardize prefixes:** `Error:` (capitalized, not ALL CAPS) for fatal, `Warning:` for non-fatal\n2. **Fix regex:** `^-?[0-9]+(\\.[0-9]+)?$` - requires digits before decimal\n3. **Let Python stderr through:** Remove `2\u003e/dev/null`, let errors flow to console naturally (Unix-y)\n4. **Narrow Python exception:** Change to `except (KeyError, TypeError, ValueError):`\n\n## Implementation Notes\n\n### Error message locations to update:\n- Line 149: `ERROR:` ‚Üí `Error:`\n- Line 185: `ERROR:` ‚Üí `Error:`\n- Line 324: Add `Error:` prefix\n- Line 367, 380: Add `Error:` prefix for unknown location\n\n### Regex fix (lines 341, 345):\n```bash\nif ! [[ \"$lat\" =~ ^-?[0-9]+(\\.[0-9]+)?$ ]]; then\n```\n\n### Python exception fix (region_lookup.py line 71):\n```python\nexcept (KeyError, TypeError, ValueError):\n    # Skip malformed features\n    continue\n```\n\n## Future work (separate task)\n- Audit other skills for error conventions before adding to repo-level CLAUDE.md\n- Don't block this fix on the broader audit\n\n## Gotchas\n- Changing error prefixes might break any tooling that greps for \"ERROR:\"\n- The regex change is stricter - ensure it doesn't reject valid coordinates\n- Removing 2\u003e/dev/null means Python errors will be visible - make sure they're user-friendly\n\n## Testing\n- Test with malformed lat/lon values (\"123.45.67\", \"-.5\", \"abc\")\n- Test Python script failure modes (network error, missing dependency)\n- Verify error messages are consistent across all code paths","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T22:36:36.726136+01:00","created_by":"jason","updated_at":"2026-01-11T09:33:40.033136+01:00","closed_at":"2026-01-11T09:33:40.033136+01:00","close_reason":"Fixed in commit d903d44 - standardized error prefixes, stricter regex, removed stderr suppression, added lazy uv check"}
{"id":"jas-6z2","title":"Remove unused SCRIPT_DIR variable","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-10T16:28:10.474592+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.566755+01:00","closed_at":"2026-01-10T16:46:55.567869+01:00","close_reason":"Already removed during P1 fixes"}
{"id":"jas-885","title":"Add example output to skitour SKILL.md","description":"## Task\nCapture actual script output and add to SKILL.md as example.\n\n## Steps\n1. Run: `./skitour.sh --location rax`\n2. Capture output (sanitize any timing variations)\n3. Add to SKILL.md under `## Example Output` section\n\n## Format\n```\n## Example Output\n\n\\`\\`\\`\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n  üìç RAX (Rax - Schneeberggebiet)\n     Coordinates: 47.706¬∞N, 15.733¬∞E\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüî∫ AVALANCHE DANGER\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n   Above treeline: 2 - Moderate\n   Below treeline: 1 - Low\n   ...\n\\`\\`\\`\n```\n\n## Acceptance Criteria\n- [ ] Example output added to SKILL.md\n- [ ] Shows all three data sections (avalanche, snow, weather)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T16:28:11.060575+01:00","created_by":"jason","updated_at":"2026-01-10T22:33:19.690275+01:00","closed_at":"2026-01-10T22:33:19.690275+01:00","close_reason":"Documentation updated in SKILL.md with prerequisites (bash 4+, uv, jq/curl/bc), 26-location table by region, example output section, and limitations"}
{"id":"jas-8ln","title":"Add curl timeout to prevent hangs","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:27:58.02433+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.564734+01:00","closed_at":"2026-01-10T16:44:44.340776+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-8ti","title":"Update SKILL.md: clarify uv is only needed for coordinate lookup","description":"## Problem\nDocumentation review found inaccuracies in SKILL.md:\n\n### 1. Example output has static date\n`Valid until: 2026-01-10` will always look stale.\n\n### 2. Coordinate feature under-documented\nDoesn't explain that `--lat/--lon` uses a Python helper with EAWS polygon data for region detection.\n\n## Agreed Approach (from user discussion)\n- **Keep uv as required** (target users should have it)\n- **Simplify the example** - remove or genericize the date\n- **Document coordinate feature** - explain how it works\n\n## Implementation Notes\n\n### Example simplification options:\n- Remove the `Valid until:` line entirely\n- Use placeholder: `Valid until: \u003cdate\u003e`\n- Add HTML comment: `\u003c!-- dates will vary --\u003e`\n\n### Coordinate feature documentation:\nAdd explanation like:\n\u003e When using `--lat` and `--lon`, the script automatically determines the correct EAWS micro-region using polygon boundary data. This requires uv to run a Python helper script (`region_lookup.py`) that performs point-in-polygon matching against official EAWS GeoJSON boundaries.\n\n### Location in doc:\nCould add a \"How it works\" section or expand the \"Quick Usage\" section.\n\n## Gotchas\n- Don't over-document - keep it concise\n- The Python helper is an implementation detail users don't need to understand deeply\n\n## Testing\n- Read through updated docs as a new user - is it clear?\n- Verify all examples actually work as shown","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-10T22:36:37.233379+01:00","created_by":"jason","updated_at":"2026-01-11T09:38:31.508674+01:00","closed_at":"2026-01-11T09:38:31.508674+01:00","close_reason":"Fixed in commit c9910df - added coordinate lookup explanation, simplified example, documented staleness warning"}
{"id":"jas-a5f","title":"Fix exit code for unknown options","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T16:27:59.49102+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.563881+01:00","closed_at":"2026-01-10T16:44:44.34185+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-bhw","title":"Audit other skills for error conventions before repo-level standardization","description":"## Background\nDuring skitour error standardization (jas-4vx), we discussed adding error conventions to repo-level CLAUDE.md. User requested we audit other skills first.\n\n## Proposed conventions (to validate)\n```markdown\n## Error Conventions (for skills)\n- Prefix: `Error:` (fatal), `Warning:` (non-fatal)\n- Always stderr for errors, stdout for data\n- Exit codes: 0=success, 1=error, 2=usage error\n- Never suppress subprocess stderr silently\n```\n\n## Task\n1. Review error handling patterns in existing plugins:\n   - weather/\n   - safe-commit/\n   - Any other skills in plugins/\n\n2. Document findings:\n   - Which conventions are already followed?\n   - Which skills are inconsistent?\n   - Any skill-specific needs that conflict with proposed conventions?\n\n3. Propose unified conventions (or note where flexibility is needed)\n\n## Agreed Approach\n- Fix skitour first (jas-4vx), don't block on this audit\n- This is a follow-up task to enable broader standardization\n\n## Output\n- Summary of findings\n- Updated proposal for repo-level CLAUDE.md\n- List of skills that would need updates to conform\n\n## Priority\nP4 - backlog. Do after skitour fixes are complete.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-11T09:26:44.277992+01:00","created_by":"jason","updated_at":"2026-01-11T09:26:44.277992+01:00","dependencies":[{"issue_id":"jas-bhw","depends_on_id":"jas-4vx","type":"blocks","created_at":"2026-01-11T09:27:35.664346+01:00","created_by":"jason"}]}
{"id":"jas-d7d","title":"Add lazy uv dependency check for coordinate lookup","description":"## Problem\nScript checks for `jq`, `curl`, `bc` at startup but not `uv`, which is needed for coordinate lookup (`--lat/--lon`).\n\nIf uv is missing and user tries coordinate lookup, they get:\n```\n./skitour.sh: line 397: uv: command not found\n```\n\n## Agreed Approach\nCheck lazily - only when coordinate lookup is actually used. Don't fail at startup for missing optional dependency.\n\n## Implementation Notes\nAdd check right before calling Python script (around line 397):\n```bash\nif \\! command -v uv \u0026\u003e/dev/null; then\n    echo \"Error: uv is required for coordinate lookup\" \u003e\u00262\n    echo \"Install: curl -LsSf https://astral.sh/uv/install.sh | sh\" \u003e\u00262\n    exit 1\nfi\n```\n\n### Placement\nThe check for `region_lookup.py` existence is already at line 390. Add uv check nearby:\n```bash\nif [[ \\! -f \"$lookup_script\" ]]; then\n    echo \"Error: region_lookup.py not found at $lookup_script\" \u003e\u00262\n    exit 1\nfi\nif \\! command -v uv \u0026\u003e/dev/null; then\n    echo \"Error: uv is required for coordinate lookup\" \u003e\u00262\n    echo \"Install: curl -LsSf https://astral.sh/uv/install.sh | sh\" \u003e\u00262\n    exit 1\nfi\n```\n\n## Context\n- Named location queries (`--location stubai`) work fine without uv\n- Only `--lat/--lon` requires the Python helper\n- This is why SKILL.md lists uv as required (target users should have it) but we don't fail at startup\n\n## Gotchas\n- Error message should be actionable (include install command)\n- Use `command -v` not `which` for POSIX compatibility\n\n## Testing\n- Uninstall/hide uv, try `--location stubai` (should work)\n- Try `--lat 47.1 --lon 11.3` (should show helpful error about uv)","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-11T09:26:44.040038+01:00","created_by":"jason","updated_at":"2026-01-11T09:33:40.038171+01:00","closed_at":"2026-01-11T09:33:40.038171+01:00","close_reason":"Fixed in commit d903d44 - standardized error prefixes, stricter regex, removed stderr suppression, added lazy uv check"}
{"id":"jas-e80","title":"Add more touring locations to skitour","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-10T16:28:11.631625+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.567169+01:00","closed_at":"2026-01-10T20:54:45.993866+01:00","close_reason":"Superseded by more detailed issue with concrete implementation plan"}
{"id":"jas-eci","title":"Adopt pre-commit hooks from apart-kit","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:11.907891+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.565171+01:00","closed_at":"2026-01-10T16:46:23.080002+01:00","close_reason":"Added .pre-commit-config.yaml with gitleaks, shellcheck, file hygiene hooks"}
{"id":"jas-ivg","title":"Optimize jq calls in weather display loop","description":"## Problem\nThe weather display loop (lines 212-225) calls jq 5 times per iteration for 12 iterations = **60 jq process spawns**.\n\n## Current Code (lines 212-225)\n```bash\nfor i in {0..11}; do\n    hour=$(echo \"$weather_json\" | jq -r \".hourly.time[$i]...\")\n    temp=$(echo \"$weather_json\" | jq -r \".hourly.temperature_2m[$i]...\")\n    wind=$(echo \"$weather_json\" | jq -r \".hourly.windspeed_10m[$i]...\")\n    cloud=$(echo \"$weather_json\" | jq -r \".hourly.cloudcover[$i]...\")\n    precip=$(echo \"$weather_json\" | jq -r \".hourly.precipitation_probability[$i]...\")\n    printf ...\ndone\n```\n\n## Solution\nSingle jq call that outputs pre-formatted lines:\n```bash\necho \"$weather_json\" | jq -r '\n    [range(12)] | .[] as $i |\n    \"\\(.hourly.time[$i] | split(\"T\")[1] | split(\":\")[0]) \\(.hourly.temperature_2m[$i]) \\(.hourly.windspeed_10m[$i]) \\(.hourly.cloudcover[$i]) \\(.hourly.precipitation_probability[$i])\"\n' | while read hour temp wind cloud precip; do\n    printf \"   %02d:00 %5.1f¬∞C %5.0fkm/h %4.0f%%   %3.0f%%\\n\" \"$hour\" \"$temp\" \"$wind\" \"$cloud\" \"$precip\"\ndone\n```\n\n## Acceptance Criteria\n- [ ] Replace 60 jq calls with 1\n- [ ] Output unchanged\n- [ ] Handle empty/error weather data gracefully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:00.830761+01:00","created_by":"jason","updated_at":"2026-01-10T22:01:21.614068+01:00","closed_at":"2026-01-10T22:01:21.614068+01:00","close_reason":"Completed: Reduced 60 jq calls to 1 using single jq filter with tab-separated output piped to while loop. Commit: 75549f7"}
{"id":"jas-kjq","title":"Add argument validation for CLI options","description":"## Current State\nNo validation - unknown options silently fail, invalid coords accepted.\n\n## Validations to Add\n\n### 1. Unknown option handling (line 243)\n```bash\n*) echo \"Unknown option: $1\" \u003e\u00262; usage; exit 1 ;;\n```\n**Fix**: Show available options before exiting.\n\n### 2. Latitude/longitude range validation\n```bash\n# After parsing --lat/--lon\nif [[ -n \"$lat\" ]]; then\n    if ! [[ \"$lat\" =~ ^-?[0-9]+\\.?[0-9]*$ ]] || \\\n       (( $(echo \"$lat \u003c 45 || $lat \u003e 49\" | bc -l) )); then\n        echo \"Error: Latitude must be between 45-49 (Austria)\" \u003e\u00262\n        exit 1\n    fi\nfi\n# Similar for lon (9-18 for Austria)\n```\n\n### 3. Empty location name\n```bash\nif [[ -z \"$location\" \u0026\u0026 -z \"$lat\" \u0026\u0026 -z \"$lon\" \u0026\u0026 -z \"$compare\" ]]; then\n    usage\nfi\n```\n\n### 4. Partial coordinate (lat without lon)\n```bash\nif [[ -n \"$lat\" \u0026\u0026 -z \"$lon\" ]] || [[ -z \"$lat\" \u0026\u0026 -n \"$lon\" ]]; then\n    echo \"Error: Both --lat and --lon required for coordinate lookup\" \u003e\u00262\n    exit 1\nfi\n```\n\n## Acceptance Criteria\n- [ ] Unknown options show help and exit 1\n- [ ] Invalid lat/lon shows error with valid range\n- [ ] Missing paired lat/lon shows clear error\n- [ ] Empty compare list handled gracefully","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:28:10.212977+01:00","created_by":"jason","updated_at":"2026-01-10T22:04:57.575684+01:00","closed_at":"2026-01-10T22:04:57.575684+01:00","close_reason":"Completed: Added validation for unknown options, partial coords, invalid format, and out-of-Austria warning. Commit: d6913ae"}
{"id":"jas-l6b","title":"Consider migrating custom slash commands to this repo","description":"## Status: DEFERRED\n\nUser decision: Keep commands in ~/.claude/commands/ separate from this skills repo for now. Revisit later.\n\n## Original Context\nEvaluate moving personal Claude Code slash commands from ~/.claude/commands/ to this marketplace repo.\n\n**Current location**: ~/.claude/commands/*.md\n**Examples**: sync-dotfiles, sync-claude-config, etc.\n\n**Questions to resolve** (when revisited):\n- Should these be plugins (with SKILL.md) or stay as simple .md commands?\n- Which commands are general-purpose vs personal?\n- How to handle commands that reference user-specific paths?","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T17:16:12.687001+01:00","created_by":"jason","updated_at":"2026-01-10T21:34:03.340023+01:00"}
{"id":"jas-ls6","title":"Add staleness indicator when avalanche bulletin is outdated","description":"## Problem\nThe avalanche.report API uses today's date in the URL:\n```bash\nurl=\"https://static.avalanche.report/bulletins/${today}/${region_code}.json\"\n```\n\nBulletins update around 17:00 CET. If someone runs the script at 10:00, they may get yesterday's bulletin without knowing it's stale.\n\nCurrently we show `Valid until: YYYY-MM-DD` but don't highlight when this date is in the past.\n\n## Agreed Approach\nAdd a staleness indicator when `validUntil \u003c today`:\n```\nüî∫ AVALANCHE DANGER\n   Danger level: 2 - Moderate\n   Valid until: 2026-01-10  ‚ö†Ô∏è (bulletin may be outdated)\n```\n\nAlso document in SKILL.md:\n\u003e If `validUntil` is before today, the bulletin is stale. Bulletins update ~17:00 CET. For critical decisions, verify at avalanche.report directly.\n\n## Implementation Notes\n- Extract date from `validUntil` (already done: line 256)\n- Compare with `$(date +%Y-%m-%d)`\n- Append warning indicator if stale\n\n```bash\nvalid=$(echo \"$avy_data\" | jq -r '.validUntil // \"\"' | cut -dT -f1)\ntoday=$(date +%Y-%m-%d)\nif [[ -n \"$valid\" \u0026\u0026 \"$valid\" \u003c \"$today\" ]]; then\n    echo \"   Valid until: $valid  ‚ö†Ô∏è (bulletin may be outdated)\"\nelse\n    echo \"   Valid until: $valid\"\nfi\n```\n\n## Context\n- Only affects AT-02 (Carinthia) and AT-07 (Tyrol) which use date-based URLs\n- Other regions use `/latest/` endpoint which auto-updates\n- This is informational - don't block or fail, just warn\n\n## Gotchas\n- String comparison works for ISO dates (YYYY-MM-DD sorts correctly)\n- Empty `validUntil` should not trigger warning\n- Timezone edge cases: bulletin says \"valid until 2026-01-11\" but it's already Jan 11 in user's timezone - still show warning? Probably yes, to be safe.\n\n## Testing\n- Test with a manually backdated bulletin\n- Test at different times of day\n- Verify warning appears only when appropriate","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-11T09:26:02.919949+01:00","created_by":"jason","updated_at":"2026-01-11T09:35:46.303849+01:00","closed_at":"2026-01-11T09:35:46.303849+01:00","close_reason":"Fixed in commit f6fd7f6 - shows warning when validUntil \u003c today"}
{"id":"jas-m5q","title":"Document bash 4+ requirement in SKILL.md","description":"## Change\nAdd prerequisites section to SKILL.md documenting all requirements.\n\n## Prerequisites to Document\n1. **bash 4.0+** - Required for associative arrays\n   - macOS ships with bash 3.x, users need `brew install bash`\n2. **uv** - Required for coordinate lookup (region_lookup.py)\n   - Install: `curl -LsSf https://astral.sh/uv/install.sh | sh`\n3. **Runtime deps** (checked by script): jq, curl, bc\n\n## Location\n`plugins/skitour/SKILL.md` - add Prerequisites section:\n\n```markdown\n## Prerequisites\n\n- **bash 4.0+** (for associative arrays)\n  - macOS: `brew install bash`\n  - Linux: Usually pre-installed\n- **uv** (for coordinate lookup feature)\n  - `curl -LsSf https://astral.sh/uv/install.sh | sh`\n- **jq, curl, bc** (checked at runtime)\n```\n\n## Acceptance Criteria\n- [ ] SKILL.md has Prerequisites section\n- [ ] bash 4+ requirement documented with macOS workaround\n- [ ] uv requirement documented with install command\n- [ ] Runtime deps listed","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T16:28:10.745093+01:00","created_by":"jason","updated_at":"2026-01-10T22:33:19.683556+01:00","closed_at":"2026-01-10T22:33:19.683556+01:00","close_reason":"Documentation updated in SKILL.md with prerequisites (bash 4+, uv, jq/curl/bc), 26-location table by region, example output section, and limitations"}
{"id":"jas-maj","title":"Remove unused variable and deduplicate location lookup","description":"## Problem\nMinor code cleanup items from red-team review:\n\n### 1. Unused variable (line 176)\n```bash\ntoday=$(date +%Y-%m-%d)  # Assigned but never used\n```\nNote: There's also a `today` on line 136 in `get_avalanche_data()` which IS used. The one on line 176 in `get_snow_depth()` is the unused one.\n\n### 2. Duplicate lookup pattern (lines 364-365 vs 377-378)\n```bash\n# In compare mode:\nIFS=',' read -r lat lon region micro \u003c\u003c\u003c \"${LOCATIONS[$loc]}\"\nshow_location \"$loc\" \"$lat\" \"$lon\" \"$region\" \"$micro\"\n\n# In single location mode (identical):\nIFS=',' read -r lat lon region micro \u003c\u003c\u003c \"${LOCATIONS[$location]}\"\nshow_location \"$location\" \"$lat\" \"$lon\" \"$region\" \"$micro\"\n```\n\n### 3. Parameter name mismatch\nFunction `show_location()` declares `micro_region` (line 235), but callers pass variable named `micro`.\n\n## Agreed Approach\n1. Remove unused `today` variable from `get_snow_depth()`\n2. Extract helper function: `lookup_and_show_location()`\n3. Rename caller variable from `micro` to `micro_region` for consistency\n\n## Implementation Notes\n\n### Helper function:\n```bash\nlookup_and_show_location() {\n    local name=\"$1\"\n    local -n loc_data=\"LOCATIONS[$name]\"  # nameref, or just pass the value\n    IFS=',' read -r lat lon region micro_region \u003c\u003c\u003c \"$loc_data\"\n    show_location \"$name\" \"$lat\" \"$lon\" \"$region\" \"$micro_region\"\n}\n```\n\nOr simpler - just rename variables in existing code without extracting function (2 lines repeated once isn't egregious).\n\n## Gotchas\n- Don't confuse the two `today` variables - line 136 is used, line 176 is not\n- The compare mode loop variable is `loc`, single mode is `location` - helper needs to accept either\n- Bash namerefs (`local -n`) require bash 4.3+ - we already require 4.0+, but verify\n\n## Testing\n- Verify compare mode still works after refactor\n- Verify single location mode still works\n- Shellcheck should pass","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-10T22:36:36.986425+01:00","created_by":"jason","updated_at":"2026-01-11T09:37:42.766472+01:00","closed_at":"2026-01-11T09:37:42.766472+01:00","close_reason":"Fixed in commit cc5b6df - renamed variable, grouped help output, added comments"}
{"id":"jas-n7u","title":"Add dependency checks for jq, curl, bc","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:27:56.636494+01:00","created_by":"jason","updated_at":"2026-01-10T21:28:32.564954+01:00","closed_at":"2026-01-10T16:44:44.338854+01:00","close_reason":"Fixed in skitour.sh: dependency checks, curl timeout, exit code"}
{"id":"jas-o7z","title":"Implement coordinate to region lookup using EAWS polygons","description":"## Goal\nEnable `--lat LAT --lon LON` to automatically determine the correct EAWS micro-region.\n\n## Implementation: Python Helper with UV Script\n\nUse a self-contained Python script with inline dependencies:\n\n```python\n#!/usr/bin/env -S uv run --script\n# /// script\n# requires-python = \"\u003e=3.10\"\n# dependencies = [\"shapely\", \"requests\"]\n# ///\n\nimport sys\nimport json\nimport requests\nfrom shapely.geometry import Point, shape\n\ndef get_region(lat: float, lon: float) -\u003e dict | None:\n    \"\"\"Return {region_code, micro_region, name} for given coordinates.\"\"\"\n    point = Point(lon, lat)  # GeoJSON is lon,lat order\n    \n    # Determine parent region from rough bounds\n    parent = None\n    if 46.7 \u003c= lat \u003c= 47.6 and 10.1 \u003c= lon \u003c= 12.9:\n        parent = \"AT-07\"\n    elif 46.4 \u003c= lat \u003c= 47.2 and 12.7 \u003c= lon \u003c= 15.1:\n        parent = \"AT-02\"\n    # ... etc for AT-03, AT-06, AT-08\n    \n    if not parent:\n        return None\n    \n    # Fetch micro-regions GeoJSON\n    url = f\"https://regions.avalanches.org/micro-regions/{parent}_micro-regions.geojson.json\"\n    resp = requests.get(url, timeout=10)\n    geojson = resp.json()\n    \n    # Find containing region\n    for feature in geojson[\"features\"]:\n        polygon = shape(feature[\"geometry\"])\n        if polygon.contains(point):\n            return {\n                \"region_code\": parent,\n                \"micro_region\": feature[\"properties\"][\"id\"],\n            }\n    \n    return None\n\nif __name__ == \"__main__\":\n    lat, lon = float(sys.argv[1]), float(sys.argv[2])\n    result = get_region(lat, lon)\n    if result:\n        print(json.dumps(result))\n    else:\n        sys.exit(1)\n```\n\n## Integration with skitour.sh\n\n```bash\n# In skitour.sh, when --lat/--lon provided:\nresult=$(uv run --script region_lookup.py \"$lat\" \"$lon\" 2\u003e/dev/null)\nif [[ -n \"$result\" ]]; then\n    region_code=$(echo \"$result\" | jq -r '.region_code')\n    micro_region=$(echo \"$result\" | jq -r '.micro_region')\n    show_location \"custom\" \"$lat\" \"$lon\" \"$region_code\" \"$micro_region\"\nelse\n    echo \"Could not determine avalanche region for coordinates.\"\n    echo \"Use --location with a known location: ${!LOCATIONS[*]}\"\n    exit 1\nfi\n```\n\n## File Structure\n```\nplugins/skitour/\n‚îú‚îÄ‚îÄ skitour.sh           # Main script\n‚îú‚îÄ‚îÄ region_lookup.py     # UV script helper\n‚îî‚îÄ‚îÄ SKILL.md\n```\n\n## Advantages\n- 100% accurate point-in-polygon with shapely\n- No system-wide Python deps (uv handles isolation)\n- Portable (just needs uv installed, which user has)\n- Simple, readable, maintainable\n- Fast (~0.5s including network fetch)\n\n## Acceptance Criteria\n- [ ] region_lookup.py works standalone: `uv run --script region_lookup.py 47.1 11.3`\n- [ ] skitour.sh --lat 47.1 --lon 11.3 returns Stubai region data\n- [ ] Out-of-Austria coords show clear error\n- [ ] Network errors handled gracefully\n- [ ] SKILL.md documents uv requirement","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-10T16:28:11.347555+01:00","created_by":"jason","updated_at":"2026-01-10T22:30:35.889846+01:00","closed_at":"2026-01-10T22:30:35.889846+01:00","close_reason":"Completed: Implemented region_lookup.py UV script with shapely point-in-polygon. Integrated into skitour.sh for --lat/--lon. Commit: 6db5972"}
{"id":"jas-rjs","title":"Add inline comments explaining magic values","description":"## Problem\nSeveral hardcoded values lack explanation:\n\n### 1. forecast_days (line 210)\n```bash\nurl+=\"\u0026forecast_days=2\"\n```\nWhy 2? (Answer: ICON-D2 model range, matches documented 48h limit)\n\n### 2. API timeout (line 10, 148, 184, 213)\n```bash\ncurl -sf --max-time 10 \"$url\"\n```\nWhy 10 seconds? (Answer: reasonable API timeout, balances responsiveness with reliability)\n\n### 3. Snow data lag (line 176)\n```bash\nyesterday=$(date -v-1d +%Y-%m-%d)  # Already has comment, but could be clearer\n```\nWhy 1 day? (Answer: GeoSphere SNOWGRID processing delay)\n\n## Agreed Approach\nAdd inline comments, don't extract to named constants (user preference: keep simple).\n\n## Implementation Notes\n\n### Line 210:\n```bash\nurl+=\"\u0026forecast_days=2\"  # ICON-D2 model provides 48h forecasts\n```\n\n### Line 10 (and similar curl calls):\n```bash\nreadonly API_TIMEOUT=10  # Or just comment at first usage\n# In fetch_api():\ncurl -sf --max-time 10 \"$url\"  # 10s timeout for API responsiveness\n```\n\n### Line 176:\n```bash\n# SNOWGRID data has 1-day processing delay\nyesterday=$(date -v-1d +%Y-%m-%d 2\u003e/dev/null || date -d \"yesterday\" +%Y-%m-%d)\n```\n\n## Gotchas\n- Don't over-comment - one clear comment per magic value is enough\n- Comments should explain WHY, not WHAT (\"10s timeout\" not \"sets timeout to 10\")\n\n## Testing\n- N/A - documentation only change\n- Shellcheck should still pass","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-11T09:27:28.969733+01:00","created_by":"jason","updated_at":"2026-01-11T09:37:42.775958+01:00","closed_at":"2026-01-11T09:37:42.775958+01:00","close_reason":"Fixed in commit cc5b6df - renamed variable, grouped help output, added comments"}
{"id":"jas-rvp","title":"Add bash version check at startup","description":"## Problem\nScript uses associative arrays (bash 4.0+ feature) but doesn't validate version at runtime. \n\nOn macOS with default bash 3.x, users get cryptic errors:\n```\ndeclare: -A: invalid option\n```\n\n## Agreed Approach\nAdd version check right after shebang:\n```bash\nif ((BASH_VERSINFO[0] \u003c 4)); then\n    echo \"Error: bash 4.0+ required (found $BASH_VERSION)\" \u003e\u00262\n    echo \"On macOS: brew install bash\" \u003e\u00262\n    exit 1\nfi\n```\n\n## Implementation Notes\n- Place immediately after the shebang and initial comments, before any other code\n- Use `BASH_VERSINFO[0]` not `BASH_VERSION` for numeric comparison\n- Exit code 1 (error), message to stderr\n- Include actionable fix for macOS users\n\n## Gotchas\n- The check itself must be bash 3.x compatible! `(( ))` arithmetic is fine in bash 3\n- Don't use associative array syntax in the error message path\n- Users who installed bash via Homebrew still need to invoke with `/opt/homebrew/bin/bash` or update their shebang - consider mentioning this\n\n## Testing\n- Test on macOS with default /bin/bash (version 3.x)\n- Verify error message is helpful and actionable","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T22:36:36.470767+01:00","created_by":"jason","updated_at":"2026-01-11T09:31:40.069114+01:00","closed_at":"2026-01-11T09:31:40.069114+01:00","close_reason":"Fixed in commit 27dc773 - proper exit code checking with clear unavailable markers, bash version check added"}
{"id":"jas-t1w","title":"Group locations by region in help output","description":"## Problem\nThe `--help` output shows available locations from an associative array:\n```bash\nAvailable locations: ${!LOCATIONS[*]}\n```\n\nAssociative arrays have no guaranteed order, so users see unsorted mess:\n```\nAvailable locations: lech stubai rax obergurgl schneeberg ...\n```\n\n## Agreed Approach\nGroup locations by region (more useful than alphabetical).\n\n## Implementation Notes\n\n### Desired output format:\n```\nAvailable locations:\n  Tyrol (AT-07):      stubai, obergurgl, soelden, mayrhofen, ...\n  Carinthia (AT-02):  heiligenblut, badkleinkirchheim, mallnitz\n  Vorarlberg (AT-08): lech, gargellen, kleinwalsertal, brand\n  Lower Austria:      rax, schneeberg, otscher, durrenstein\n  Styria:             hochschwab, schneealpe, veitsch, stuhleck\n```\n\n### Implementation approach:\nEither:\n1. Hardcode the grouped display in usage() function\n2. Dynamically group by extracting region code from LOCATIONS values\n\nOption 1 is simpler but needs manual update when adding locations.\nOption 2 is more maintainable:\n```bash\n# Group locations by region\ndeclare -A by_region\nfor loc in \"${!LOCATIONS[@]}\"; do\n    IFS=',' read -r _ _ region _ \u003c\u003c\u003c \"${LOCATIONS[$loc]}\"\n    by_region[$region]+=\"$loc \"\ndone\nfor region in AT-07 AT-02 AT-08 AT-03 AT-06; do\n    echo \"  $region: ${by_region[$region]}\"\ndone\n```\n\n## Gotchas\n- Keep consistent order of regions (maybe by importance: Tyrol first as most popular touring destination)\n- Consider terminal width - long lines may wrap awkwardly\n- The SKILL.md table already provides nice grouped reference - help output is for quick CLI reference\n\n## Testing\n- Run `./skitour.sh --help` and verify output is organized\n- Ensure all locations appear (none missing from grouping logic)","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-11T09:26:05.43554+01:00","created_by":"jason","updated_at":"2026-01-11T09:37:42.772015+01:00","closed_at":"2026-01-11T09:37:42.772015+01:00","close_reason":"Fixed in commit cc5b6df - renamed variable, grouped help output, added comments"}
{"id":"jas-yn6","title":"Fix function return value handling - exit codes ignored by callers","description":"## Problem\nThree functions return error codes but callers never check them:\n- `get_avalanche_data()` returns 1 on failure (line 150) - caller at line 247 ignores\n- `get_snow_depth()` returns 1 on failure (line 186) - caller at line 276 ignores  \n- `get_weather()` returns `{\"error\": \"...\"}` JSON instead of exit code - caller CAN'T detect failure\n\n### Consequence\nIf an API fails, script continues with garbage data. User sees partial/wrong output without knowing something broke.\n\n### Additional wrinkle: snow depth ambiguity\n`get_snow_depth()` returns \"0\" for both actual zero AND data unavailable - users can't distinguish.\n\n## Agreed Approach (from user discussion)\n**Graceful degradation with explicit unavailable markers:**\n- Show available data sections\n- Mark unavailable sections clearly (e.g., \"‚ùå Weather: unavailable\" or \"Avalanche data unavailable\")\n- Ensure clear errors returned so neither agents nor humans are in the dark about which data source failed\n\n## Implementation Notes\n\n### For each function:\n1. `get_avalanche_data()`: Already returns exit 1, just need to CHECK it at line 247\n2. `get_snow_depth()`: Returns exit 1, check at line 276. Also need to distinguish 0cm from unavailable (maybe return \"N/A\" string on failure?)\n3. `get_weather()`: Change to return exit 1 on failure instead of error JSON. Check at line 284.\n\n### Display pattern:\n```bash\nif ! avy_data=$(get_avalanche_data \"$region\" \"$micro\"); then\n    echo \"üî∫ AVALANCHE DANGER\"\n    echo \"   ‚ùå Data unavailable\"\nelse\n    # normal display\nfi\n```\n\n### Gotchas\n- Don't break the compare mode (--compare) - it loops through multiple locations, each can independently fail\n- Snow depth \"0\" is valid in summer/low elevations - need separate signal for \"unavailable\"\n- Weather display has complex jq pipeline - failure point is the curl, not the jq\n\n## Testing\n- Test each API failure independently (use invalid region code, network timeout simulation)\n- Test partial failure (one API works, another fails)\n- Verify compare mode handles mixed success/failure across locations","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T22:36:36.205276+01:00","created_by":"jason","updated_at":"2026-01-11T09:31:40.063635+01:00","closed_at":"2026-01-11T09:31:40.063635+01:00","close_reason":"Fixed in commit 27dc773 - proper exit code checking with clear unavailable markers, bash version check added"}
{"id":"jas-z75","title":"Investigate Salzburg (AT-05) avalanche data source","description":"## Background\nDuring jas-4pz implementation, discovered that AT-05 (Salzburg) returns malformed JSON from lawinen-warnung.eu.\n\n## Symptoms\n```bash\ncurl -sf 'https://static.lawinen-warnung.eu/bulletins/latest/AT-05.json' | jq 'length'\n# Returns: jq parse error (control characters)\n```\n\n## Investigation Needed\n1. Check if AT-05 uses a different API (like AT-02/AT-07 use avalanche.report)\n2. Verify if the JSON encoding issue is transient or permanent\n3. Find alternative data source if needed\n\n## Context\nSalzburg is a major touring destination (Pinzgau, Pongau areas) so adding support would be valuable.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-10T22:19:11.661662+01:00","created_by":"jason","updated_at":"2026-01-10T22:19:11.661662+01:00"}
